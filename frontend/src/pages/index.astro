---
import BaseLayout from "../layouts/BaseLayout.astro";
import ProductsList from "../components/ProductsList.astro";
import Filter from "../components/Filter.astro";
import fetchApi from "../wrapper/strapi.js";

const products = await fetchApi({
  endpoint: "products",
  wrappedByKey: "data",
  query: { populate: ["image", "category"] },
});

const categories = await fetchApi({
  endpoint: "categories",
  wrappedByKey: "data",
});
---

<BaseLayout pageTitle="Home">
  <Filter client:load categories={categories} />
  <ProductsList products={products} />
</BaseLayout>
